#!/usr/bin/env bash
#

set -o nounset
set -o errexit
set -o pipefail

cd "$(git rev-parse --show-toplevel)"

source scripts/funcs

# --dirty to flag changes to your working tree
RELEASE_VERSION=$(git describe --dirty)

echo "Building Operator binary..."

CGO_ENABLED=0 GOOS=linux go build -i -o docker/mongodb-enterprise-operator/content/mongodb-enterprise-operator -ldflags="-X main.operatorVersion=$RELEASE_VERSION"

echo "Operator successfully built (version ${RELEASE_VERSION})"
